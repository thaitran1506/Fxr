


```{r}
setwd("~/Desktop/FXR analysis/Fxr/Data")
#setwd("~/Desktop/FXR analysis/Fxr/Data")
shared = read.csv("shared between HFD and HFD+XN.csv", row.names = 1, stringsAsFactors = FALSE)
head(shared)
```

```{r}
library(DESeq2)
library(ggplot2)
library(pheatmap)
library(RColorBrewer)
```

```{r}
heatmap = pheatmap(shared_2, treeheight_col = 0, color = colorRampPalette(rev(brewer.pal(10, "RdYlBu")))(30), fontsize_number = 1.5, cluster_rows = F)
```
```{r}
dist = dist(shared)
hc = hclust(dist, method = "ward.D2")
```

```{r}
shared_2 = shared[rev(hc$order),]

```

```{r}
shared_2 = shared_2[rev(heatmap$tree_row$order),]
#shared_2 = shared[c(rev(heatmap$tree_row$order[1:84]), rev(heatmap$tree_row$order[85:2])),]
#shared_2 = shared_2[rev(row.names(shared_2)),]
```

```{r}
heatmap$tree_row$order
```

```{r}
row.names(metabolic_df_2) = metabolic_df_2$Symbol
```

```{r}
setwd("~/Desktop/FXR analysis/Fxr/Data")
#setwd("~/Desktop/FXR analysis/Fxr/Data")
jpeg("heat map of shared genes.jpeg", width = 1000, height = 3000)
pheatmap(shared_2, treeheight_row = 0, treeheight_col = 0, color = colorRampPalette(rev(brewer.pal(10, "RdYlBu")))(30), fontsize_number = 1000, cluster_rows = F)
dev.off()
```

When I left the function to automatically cluster the genes, it gave some weird clustering results. Not all the upregulated genes are clustered together and same went for the downregulated genes. So I had to use the function hclust to calculate the order of the genes. First use the function dist() to calcuate the distance between genes then use hclust() with attribute method = "ward.D2" to get the desired order of genes. Finaly graph the heatmap and set the attribute cluster_rows = F to avoid clustering again. 